
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\ImageTransformations.py:78: RuntimeWarning: invalid value encountered in true_divide
  mean1 = np.cumsum(hist * bin_mids) / weight1
C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\ImageTransformations.py:80: RuntimeWarning: invalid value encountered in true_divide
  mean2 = (np.cumsum((hist * bin_mids)[::-1]) / weight2[::-1])[::-1]
(102, 30, 114)

 15%|███████████████████▌                                                                                                                 | 5/34 [00:15<00:50,  1.74s/it]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:16<00:23,  1.15it/s]
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:21<00:27,  1.14s/it]
(90, 40, 116)


 53%|█████████████████████████████████████████████████████████████████████▉                                                              | 18/34 [00:27<00:09,  1.60it/s]

 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:29<00:03,  2.94it/s]

 71%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                      | 24/34 [00:31<00:08,  1.17it/s]


 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:36<00:05,  1.16s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 32/34 [00:38<00:01,  1.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:40<00:00,  1.19s/it]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:22,  1.39it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:06<00:16,  1.66it/s]
(102, 30, 114)
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:15<00:37,  1.58s/it]
(90, 40, 116)

 41%|██████████████████████████████████████████████████████▎                                                                             | 14/34 [00:19<00:16,  1.23it/s]


 53%|█████████████████████████████████████████████████████████████████████▉                                                              | 18/34 [00:22<00:10,  1.55it/s]


 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:26<00:02,  2.49it/s]

 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:33<00:07,  1.57s/it]
(70, 28, 90)

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:37<00:00,  1.10s/it]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)


 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:14,  1.92it/s]
(102, 30, 114)
(90, 40, 116)
(90, 40, 116)


 41%|██████████████████████████████████████████████████████▎                                                                             | 14/34 [00:15<00:13,  1.51it/s]

 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:16<00:09,  1.94it/s]

 53%|█████████████████████████████████████████████████████████████████████▉                                                              | 18/34 [00:18<00:09,  1.74it/s]

 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:20<00:03,  2.80it/s]


 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:29<00:06,  1.40s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 32/34 [00:31<00:01,  1.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:32<00:00,  1.03it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)


 15%|███████████████████▌                                                                                                                 | 5/34 [00:05<00:27,  1.07it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:13,  1.96it/s]
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:11<00:25,  1.06s/it]
(90, 40, 116)

 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:14<00:09,  2.10it/s]


 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:18<00:03,  3.08it/s]

 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:20<00:02,  2.79it/s]
(102, 54, 126)
(70, 28, 90)

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:29<00:00,  1.17it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:19,  1.57it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:12,  2.22it/s]
(90, 40, 116)
(90, 40, 116)


 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:13<00:08,  2.13it/s]

 53%|█████████████████████████████████████████████████████████████████████▉                                                              | 18/34 [00:16<00:08,  1.91it/s]

 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:18<00:03,  3.09it/s]
(89, 48, 138)


 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:25<00:06,  1.25s/it]
(70, 28, 90)

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:30<00:00,  1.13it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)

  9%|███████████▋                                                                                                                         | 3/34 [00:03<00:23,  1.31it/s]


 21%|███████████████████████████▍                                                                                                         | 7/34 [00:06<00:15,  1.78it/s]
(90, 40, 116)
(90, 40, 116)


 41%|██████████████████████████████████████████████████████▎                                                                             | 14/34 [00:14<00:11,  1.79it/s]
(154, 60, 156)


 62%|█████████████████████████████████████████████████████████████████████████████████▌                                                  | 21/34 [00:18<00:06,  2.12it/s]
(89, 48, 138)



 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:25<00:05,  1.20s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 32/34 [00:27<00:01,  1.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:30<00:00,  1.13it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:21,  1.41it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:13,  2.07it/s]
(102, 30, 114)
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:11<00:24,  1.03s/it]

 41%|██████████████████████████████████████████████████████▎                                                                             | 14/34 [00:14<00:12,  1.55it/s]
(154, 60, 156)


 56%|█████████████████████████████████████████████████████████████████████████▊                                                          | 19/34 [00:18<00:12,  1.17it/s]


 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:21<00:02,  2.63it/s]
(102, 54, 126)

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 30/34 [00:28<00:05,  1.40s/it]
(64, 28, 76)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:30<00:00,  1.12it/s]

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:22,  1.38it/s]
(102, 30, 114)

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:13,  1.98it/s]
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:11<00:24,  1.03s/it]

 38%|██████████████████████████████████████████████████▍                                                                                 | 13/34 [00:14<00:16,  1.24it/s]

 50%|██████████████████████████████████████████████████████████████████                                                                  | 17/34 [00:16<00:10,  1.56it/s]

 62%|█████████████████████████████████████████████████████████████████████████████████▌                                                  | 21/34 [00:18<00:06,  2.16it/s]


 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:21<00:02,  2.35it/s]
(102, 54, 126)

 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:26<00:06,  1.32s/it]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:30<00:00,  1.13it/s]
(78, 42, 104)
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]


 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:14,  1.91it/s]
(102, 30, 114)
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:11<00:26,  1.09s/it]

 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:14<00:08,  2.26it/s]
(154, 60, 156)


 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:19<00:04,  2.68it/s]

 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:21<00:02,  2.50it/s]

 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:27<00:06,  1.40s/it]
(70, 28, 90)

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:30<00:00,  1.10it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:19,  1.63it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:12,  2.11it/s]
(90, 40, 116)
(90, 40, 116)

 29%|██████████████████████████████████████▊                                                                                             | 10/34 [00:10<00:25,  1.06s/it]

 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:14<00:09,  2.09it/s]


 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:18<00:03,  2.84it/s]

 71%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                      | 24/34 [00:21<00:10,  1.02s/it]


 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                       | 28/34 [00:27<00:12,  2.05s/it]

 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 31/34 [00:29<00:03,  1.13s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:31<00:00,  1.09it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]
(78, 42, 104)


 21%|███████████████████████████▍                                                                                                         | 7/34 [00:05<00:14,  1.85it/s]
(102, 30, 114)
(90, 40, 116)
(90, 40, 116)


 44%|██████████████████████████████████████████████████████████▏                                                                         | 15/34 [00:15<00:10,  1.90it/s]
(154, 60, 156)


 68%|█████████████████████████████████████████████████████████████████████████████████████████▎                                          | 23/34 [00:21<00:04,  2.62it/s]

 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 27/34 [00:23<00:02,  2.51it/s]

 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 29/34 [00:29<00:06,  1.34s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 32/34 [00:31<00:01,  1.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:33<00:00,  1.03it/s]
  0%|                                                                                                                                             | 0/34 [00:00<?, ?it/s]

  9%|███████████▋                                                                                                                         | 3/34 [00:02<00:22,  1.37it/s]

 21%|███████████████████████████▍                                                                                                         | 7/34 [00:06<00:14,  1.81it/s]
(102, 30, 114)
(90, 40, 116)
 21%|███████████████████████████▍                                                                                                         | 7/34 [00:11<00:42,  1.58s/it]
Traceback (most recent call last):
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\trainSegmentationUnet.py", line 77, in <module>
    train(20, model, optimizer, None, loss)
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\trainSegmentationUnet.py", line 37, in train
    for element in tqdm(dataloader):
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\tqdm\std.py", line 1180, in __iter__
    for obj in iterable:
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\torch\utils\data\dataloader.py", line 521, in __next__
    data = self._next_data()
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\torch\utils\data\dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\torch\utils\data\_utils\fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\torch\utils\data\_utils\fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\DataLoader.py", line 77, in __getitem__
    def __len__(self):
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\DataLoader.py", line 49, in _read_images
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\ImageReader.py", line 70, in read_img_and_points
    img, trf = io.load_nifti_img(path + img_path)
  File "C:\Users\Usuario\Desktop\Uni\DataDaniMAPSIV\PSIV\02-Cancer_diagnosis\code\IOFunctions.py", line 18, in load_nifti_img
    out_nii_array = np.array(nim.get_fdata(), dtype=dtypes)
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\nibabel\dataobj_images.py", line 355, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\nibabel\arrayproxy.py", line 391, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\nibabel\arrayproxy.py", line 358, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\nibabel\arrayproxy.py", line 332, in _get_unscaled
    return array_from_file(self._shape,
  File "C:\Users\Usuario\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\nibabel\volumeutils.py", line 522, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.9_3.9.2544.0_x64__qbz5n2kfra8p0\lib\gzip.py", line 300, in read
    return self._buffer.read(size)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.9_3.9.2544.0_x64__qbz5n2kfra8p0\lib\_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.9_3.9.2544.0_x64__qbz5n2kfra8p0\lib\gzip.py", line 495, in read
    uncompress = self._decompressor.decompress(buf, size)
KeyboardInterrupt